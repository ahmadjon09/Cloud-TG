<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cloud Â· Storage</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="/public/app.css">
</head>

<body>

    <div class="app-container">

        <!-- Header -->
        <div class="header">
            <div class="user-info">
                <span class="user-name" id="who">Loading...</span>
                <span class="user-status" id="status">
                    <span class="status-dot"></span>
                    Initializing...
                </span>
            </div>
            <button class="refresh-btn" id="refresh" title="Refresh">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-layer-group"></i> Total files</div>
                <div class="stat-value" id="totalFiles">0</div>
                <div class="stat-sub">in cloud storage</div>
            </div>
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-database"></i> Storage used</div>
                <div class="stat-value" id="totalSize">0 B</div>
                <div class="stat-sub">across all files</div>
            </div>
        </div>

        <!-- Categories -->
        <div class="categories-section">
            <div class="section-header">
                <h2 class="section-title">Categories</h2>
                <span class="section-badge" id="fileCount">0 items</span>
            </div>
            <div class="categories-scroll">
                <button class="category-chip active" data-category="all">
                    <i class="fas fa-border-all"></i> All
                </button>
                <button class="category-chip" data-category="images">
                    <i class="fas fa-image"></i> Images
                </button>
                <button class="category-chip" data-category="documents">
                    <i class="fas fa-file-lines"></i> Documents
                </button>
                <button class="category-chip" data-category="videos">
                    <i class="fas fa-video"></i> Videos
                </button>
                <button class="category-chip" data-category="audio">
                    <i class="fas fa-music"></i> Audio
                </button>
                <button class="category-chip" data-category="archives">
                    <i class="fas fa-file-zipper"></i> Archives
                </button>
            </div>
        </div>

        <!-- Files Header -->
        <div class="section-header">
            <h2 class="section-title">Your files</h2>
            <button class="sort-button" id="sortBtn">
                <i class="fas fa-arrow-down-wide-short"></i>
                <span id="sortText">Latest</span>
            </button>
        </div>

        <!-- Files List -->
        <div id="list" class="files-grid"></div>

    </div>

    <!-- ===== PREVIEW MODAL ===== -->
    <div class="preview-modal" id="previewModal">
        <div class="preview-content">
            <div class="preview-header">
                <button class="preview-close" id="previewClose" title="Close">
                    <i class="fas fa-xmark"></i>
                </button>
                <span class="preview-title" id="previewTitle">Preview</span>
                <div class="preview-actions">
                    <button class="preview-action-btn" id="previewSend" title="Send via Bot">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            <div class="preview-body" id="previewBody"></div>
        </div>
    </div>

    <!-- ===== EDIT MODAL ===== -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">File details</span>
                <button class="close-btn" id="close"><i class="fas fa-xmark"></i></button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label class="input-label"><i class="fas fa-file"></i> File name</label>
                    <input type="text" class="input-field" id="m_name" placeholder="Enter file name" maxlength="200">
                </div>
                <div class="input-group">
                    <label class="input-label"><i class="fas fa-note-sticky"></i> Note</label>
                    <textarea class="input-field" id="m_note" placeholder="Add a note..." rows="3"
                        maxlength="500"></textarea>
                </div>
                <div class="meta-info" id="m_meta"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="saveChanges">
                    <i class="fas fa-floppy-disk"></i> Save
                </button>
                <button class="btn btn-secondary" id="sendToBot">
                    <i class="fas fa-paper-plane"></i> Send
                </button>
            </div>
            <div class="error-suggestion" id="errorSuggestion" style="display:none;">
                <i class="fas fa-circle-exclamation"></i>
                <span id="errorMessage">Error occurred</span>
                <button class="btn btn-primary btn-small" id="suggestSendViaBot">
                    <i class="fas fa-paper-plane"></i> Send via Bot
                </button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <button class="context-item" data-action="preview">
            <i class="fas fa-eye"></i> Preview
        </button>
        <button class="context-item" data-action="send">
            <i class="fas fa-paper-plane"></i> Send via Bot
        </button>
        <button class="context-item" data-action="edit">
            <i class="fas fa-pen"></i> Edit details
        </button>
    </div>

    <script src="/public/app.js" defer></script>
</body>

</html>